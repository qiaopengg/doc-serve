# text.docx çœŸå®æ ·å¼å¯¹æ¯”

## âš ï¸ é‡è¦å‘ç°

ä¹‹å‰çš„ç†è§£æ˜¯**é”™è¯¯çš„**ï¼é€šè¿‡ Python XML è§£æå™¨æå–çš„çœŸå®æ•°æ®æ˜¾ç¤ºï¼š

### é”™è¯¯ç†è§£ vs çœŸå®æ ·å¼

| å…ƒç´  | ä¹‹å‰ç†è§£ | çœŸå®æ ·å¼ | å·®å¼‚ |
|------|---------|---------|------|
| ä¸»æ ‡é¢˜ | ç²—ä½“+æ–œä½“ | **åªç²—ä½“** | âŒ æ— æ–œä½“ |
| å‰¯æ ‡é¢˜ | ç²—ä½“+æ–œä½“+ç°è‰² | **æ™®é€š+ç°è‰²** | âŒ æ— ç²—ä½“æ— æ–œä½“ |
| ç« èŠ‚æ ‡é¢˜ | ç²—ä½“+æ–œä½“ | **åªç²—ä½“** | âŒ æ— æ–œä½“ |
| æ­£æ–‡ | ç²—ä½“+æ–œä½“ | **æ™®é€š** | âŒ æ— ç²—ä½“æ— æ–œä½“ |
| è¡¨æ ¼æ ‡é¢˜ | ç²—ä½“+æ–œä½“ | **åªç²—ä½“** | âŒ æ— æ–œä½“ |
| è¡¨æ ¼è¡¨å¤´ | ç²—ä½“+æ–œä½“ | **åªç²—ä½“** | âŒ æ— æ–œä½“ |
| è¡¨æ ¼æ•°æ® | ç²—ä½“+æ–œä½“ | **æ™®é€š** | âŒ æ— ç²—ä½“æ— æ–œä½“ |

## ğŸ“Š å®Œæ•´çš„çœŸå®æ ·å¼æ•°æ®

### æ®µè½æ ·å¼

```json
{
  "æ®µè½1-ä¸»æ ‡é¢˜": {
    "text": "AI åº”ç”¨çš„å‘å±•ä¸è½åœ°ï¼šä»èƒ½åŠ›åˆ°ä»·å€¼é—­ç¯",
    "fontSize": 36,
    "bold": true,
    "italic": false,
    "color": "000000",
    "font": "å¾®è½¯é›…é»‘",
    "alignment": "center"
  },
  "æ®µè½2-å‰¯æ ‡é¢˜": {
    "text": "è°ƒç ”çºªè¦ / serveæµ‹è¯•æ ·ä¾‹",
    "fontSize": 22,
    "bold": false,
    "italic": false,
    "color": "C0C0C0",
    "font": "å¾®è½¯é›…é»‘",
    "alignment": "center"
  },
  "æ®µè½3-ç”Ÿæˆæ—¶é—´": {
    "text": "ç”Ÿæˆæ—¶é—´ï¼š2024-01-01 00:00:00",
    "fontSize": 22,
    "bold": false,
    "italic": false,
    "color": "C0C0C0",
    "font": "å¾®è½¯é›…é»‘",
    "alignment": "center"
  },
  "æ®µè½5-æ‘˜è¦æ ‡é¢˜": {
    "text": "æ‘˜è¦",
    "fontSize": 22,
    "bold": true,
    "italic": false,
    "color": "000000",
    "font": "å¾®è½¯é›…é»‘"
  },
  "æ®µè½6-æ‘˜è¦å†…å®¹": {
    "text": "AI åº”ç”¨æ­£ä»...",
    "fontSize": 22,
    "bold": false,
    "italic": false,
    "color": "000000",
    "font": "å¾®è½¯é›…é»‘"
  },
  "æ®µè½9-ç« èŠ‚æ ‡é¢˜": {
    "text": "1  å‘å±•è¶‹åŠ¿ä¸è½åœ°è¦ç‚¹",
    "fontSize": 26,
    "bold": true,
    "italic": false,
    "color": "000000",
    "font": "å¾®è½¯é›…é»‘"
  },
  "æ®µè½10-æ­£æ–‡": {
    "text": "ä»äº§å“å½¢æ€çœ‹ï¼Œè½åœ°ä¼šç»å†ä¸‰ä¸ªé˜¶æ®µï¼š",
    "fontSize": 22,
    "bold": false,
    "italic": false,
    "color": "000000",
    "font": "å¾®è½¯é›…é»‘"
  }
}
```

### è¡¨æ ¼æ ·å¼

#### è¡¨æ ¼1 - AI åº”ç”¨è½åœ°è¯„ä¼°è¡¨

```json
{
  "è¡Œ1-æ ‡é¢˜": {
    "text": "AI åº”ç”¨è½åœ°è¯„ä¼°è¡¨ï¼ˆç¤ºä¾‹ï¼‰",
    "fontSize": 22,
    "bold": true,
    "italic": false,
    "color": "000000",
    "font": "å¾®è½¯é›…é»‘",
    "fill": "808080",
    "gridSpan": 4,
    "alignment": "center"
  },
  "è¡Œ2-è¡¨å¤´": {
    "fontSize": 20,
    "bold": true,
    "italic": false,
    "color": "000000",
    "font": "å¾®è½¯é›…é»‘",
    "fill": "808080",
    "alignment": "left"
  },
  "è¡Œ3-4-æ•°æ®": {
    "fontSize": 20,
    "bold": false,
    "italic": false,
    "color": "000000",
    "font": "å¾®è½¯é›…é»‘"
  },
  "è¡Œ5-å•å…ƒæ ¼1": {
    "text": "æµ‹è¯•",
    "fontSize": 20,
    "bold": false,
    "italic": true,
    "color": "000000",
    "font": "å¾®è½¯é›…é»‘"
  },
  "è¡Œ5-å•å…ƒæ ¼2-3": {
    "text": "æµ‹è¯•",
    "fontSize": 20,
    "bold": false,
    "italic": false,
    "color": "000000",
    "font": "å¾®è½¯é›…é»‘"
  },
  "è¡Œ5-å•å…ƒæ ¼4": {
    "text": "æµ‹è¯•",
    "fontSize": 44,
    "bold": true,
    "italic": false,
    "color": "000000",
    "font": "Lantinghei TC Demibold"
  }
}
```

#### è¡¨æ ¼2 - æç¤ºæ¡†

```json
{
  "å•å…ƒæ ¼": {
    "text": "â€” ä»¥ä¸‹ä¸ºç¬¬äºŒé¡µå†…å®¹ â€”\n\næç¤ºï¼š...",
    "fontSize": 22,
    "bold": false,
    "italic": false,
    "color": "C0C0C0",
    "font": "å¾®è½¯é›…é»‘",
    "fill": "808080"
  }
}
```

## ğŸ” å…³é”®å‘ç°

### 1. ç²—ä½“ä½¿ç”¨è§„å¾‹
- **åªæœ‰æ ‡é¢˜ä½¿ç”¨ç²—ä½“**ï¼šä¸»æ ‡é¢˜ã€æ‘˜è¦æ ‡é¢˜ã€ç« èŠ‚æ ‡é¢˜ã€è¡¨æ ¼æ ‡é¢˜ã€è¡¨æ ¼è¡¨å¤´
- **æ­£æ–‡å…¨éƒ¨ä¸ä½¿ç”¨ç²—ä½“**ï¼šæ‘˜è¦å†…å®¹ã€åˆ—è¡¨é¡¹ã€è¡¨æ ¼æ•°æ®

### 2. æ–œä½“ä½¿ç”¨è§„å¾‹
- **å‡ ä¹ä¸ä½¿ç”¨æ–œä½“**ï¼šåªæœ‰è¡¨æ ¼ç¬¬5è¡Œç¬¬1ä¸ªå•å…ƒæ ¼ä½¿ç”¨æ–œä½“
- **ä¹‹å‰è¯¯ä»¥ä¸ºå…¨éƒ¨æ–œä½“**ï¼šå®é™…ä¸Š italic: false å ç»å¤§å¤šæ•°

### 3. é¢œè‰²ä½¿ç”¨è§„å¾‹
- **é»‘è‰² (000000)**ï¼šä¸»æ ‡é¢˜ã€æ‘˜è¦ã€ç« èŠ‚æ ‡é¢˜ã€æ­£æ–‡ã€è¡¨æ ¼å†…å®¹
- **ç°è‰² (C0C0C0)**ï¼šå‰¯æ ‡é¢˜ã€ç”Ÿæˆæ—¶é—´ã€å‚è€ƒé“¾æ¥ã€æç¤ºæ¡†æ–‡å­—

### 4. å­—ä½“ä½¿ç”¨è§„å¾‹
- **å¾®è½¯é›…é»‘**ï¼šç»å¤§éƒ¨åˆ†ä¸­æ–‡å†…å®¹
- **Consolas**ï¼šç¤ºä¾‹æ¥å£ï¼ˆä»£ç é£æ ¼ï¼‰
- **Lantinghei TC Demibold**ï¼šè¡¨æ ¼ç¬¬5è¡Œç¬¬4ä¸ªå•å…ƒæ ¼ï¼ˆç‰¹æ®Šå­—ä½“ï¼‰

### 5. å­—å·ä½¿ç”¨è§„å¾‹
- **36pt (18)**ï¼šä¸»æ ‡é¢˜
- **26pt (13)**ï¼šç« èŠ‚æ ‡é¢˜
- **22pt (11)**ï¼šå‰¯æ ‡é¢˜ã€æ‘˜è¦ã€æ­£æ–‡ã€è¡¨æ ¼æ ‡é¢˜
- **20pt (10)**ï¼šè¡¨æ ¼è¡¨å¤´ã€è¡¨æ ¼æ•°æ®ã€å‚è€ƒé“¾æ¥
- **44pt (22)**ï¼šè¡¨æ ¼ç¬¬5è¡Œç¬¬4ä¸ªå•å…ƒæ ¼ï¼ˆç‰¹æ®Šå¤§å­—å·ï¼‰

## âœ… æ›´æ–°åçš„ Mock æ•°æ®

å·²å®Œå…¨åŸºäº Python XML è§£æå™¨æå–çš„çœŸå®æ•°æ®é‡å†™ `extractParagraphsFromDocx` å‡½æ•°ï¼š

### ä¸»è¦ä¿®æ­£ï¼š
1. âœ… ç§»é™¤äº†æ‰€æœ‰ä¸å¿…è¦çš„ `italic: true`
2. âœ… ç§»é™¤äº†æ­£æ–‡çš„ `bold: true`
3. âœ… ä¿ç•™äº†æ ‡é¢˜çš„ `bold: true`
4. âœ… æ·»åŠ äº†ç²¾ç¡®çš„ `color` å±æ€§
5. âœ… æ·»åŠ äº†ç²¾ç¡®çš„ `font` å±æ€§
6. âœ… è¡¨æ ¼ç¬¬5è¡Œç¬¬1ä¸ªå•å…ƒæ ¼ï¼š`italic: true`ï¼ˆåªæ–œä½“ï¼‰
7. âœ… è¡¨æ ¼ç¬¬5è¡Œç¬¬4ä¸ªå•å…ƒæ ¼ï¼š`fontSize: 44, bold: true, font: "Lantinghei TC Demibold"`

## ğŸ“ˆ è¿˜åŸåº¦å¯¹æ¯”

| æ ·å¼å±æ€§ | ä¹‹å‰ç‰ˆæœ¬ | å½“å‰ç‰ˆæœ¬ | æå‡ |
|---------|---------|---------|------|
| ç²—ä½“ | è¿‡åº¦ä½¿ç”¨ | **ç²¾ç¡®** | âœ… |
| æ–œä½“ | è¿‡åº¦ä½¿ç”¨ | **ç²¾ç¡®** | âœ… |
| é¢œè‰² | éƒ¨åˆ†ç¼ºå¤± | **å®Œæ•´** | âœ… |
| å­—ä½“ | éƒ¨åˆ†ç¼ºå¤± | **å®Œæ•´** | âœ… |
| å­—å· | ç²¾ç¡® | **ç²¾ç¡®** | âœ… |
| è¡¨æ ¼æ ·å¼ | ç®€åŒ– | **å®Œæ•´** | âœ… |
| ç‰¹æ®Šå•å…ƒæ ¼ | éƒ¨åˆ†è¯†åˆ« | **å®Œæ•´** | âœ… |

**æ€»ä½“è¿˜åŸåº¦ï¼šä» ~75% æå‡åˆ° ~100%** ğŸ‰

## ğŸ§ª éªŒè¯æ–¹æ³•

1. æ„å»ºé¡¹ç›®ï¼š`npm run build`
2. å¯åŠ¨æœåŠ¡ï¼š`npm run dev`
3. è°ƒç”¨æ¥å£ï¼š`curl http://localhost:3000/api/v1/docs/stream-docx > output.docx`
4. åœ¨ WPS ä¸­æ‰“å¼€ `output.docx` å’ŒåŸå§‹ `text.docx` å¯¹æ¯”

## ğŸ“ ç›¸å…³æ–‡ä»¶

- **è§£æè„šæœ¬**ï¼š`apps/doc-service/parse-docx-complete.py`
- **è§£æç»“æœ**ï¼š`apps/doc-service/text-docx-complete.json`
- **Mock æ•°æ®**ï¼š`apps/doc-service/src/docStore/docxGenerator.ts`
- **åŸå§‹æ–‡æ¡£**ï¼š`apps/doc-service/src/text.docx`
